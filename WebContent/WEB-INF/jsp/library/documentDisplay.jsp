<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<%@ taglib prefix="form" uri="/WEB-INF/tlds/cera_form.tld" %> 
<%@ taglib prefix="cera" uri="/WEB-INF/tlds/cera.tld" %> 
 

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="author" content="${command.displayName}">
		<meta name="robots" content="index, follow">
		<meta name="google-site-verification" content="JC96M8paj34ChCcPK0EAKWSzDJqocRo6rdSqnzPbIm4" />
		<meta name="description" content="Jhapak, ${command.title}. ${command.metaDescription}" />
		<meta name="keywords" content="Jhapak, file, folder, add-file, community" />
		<title>${command.title} - Jhapak</title>
		<link rel="icon" type="image/png" href="img/link_Image.png"/>
		<link rel="canonical" href="${communityEraContext.requestUrl}" />
		<link rel="publisher" href="https://plus.google.com/+Jhapak4u"/>
		<meta property="article:publisher" content="https://www.facebook.com/EraOfCommunities" />
		
		<!-- JSON-LD markup generated by Google Structured Data Markup Helper. -->
		<script type="application/ld+json">
			{
  				"@context" : "http://schema.org",
  				"@type" : "Article",
  				"name" : "${command.title}",
  				"author" : {
    				"@type" : "Person",
    				"name" : "${command.displayName}"
  				},
  				"datePublished" : "${command.isoPostedOn}",
				"headline" : "${command.title}",
  				"image" : "${command.markupImage}",
  				"articleBody" : "${command.metaDescription}",
  				"url" : "${communityEraContext.requestUrl}"
			}
		</script>
		
		<!-- Twitter Card data -->
		<c:choose>
			<c:when test="${command.iconType == 'img'}">	
				<meta name="twitter:card" content="summary_large_image">	
			</c:when>
			<c:otherwise>
				<meta name="twitter:card" content="summary">
			</c:otherwise>
		</c:choose>
		<meta name="twitter:card" content="summary_large_image">
		<meta name="twitter:site" content="@EraCommunity">
		<meta name="twitter:title" content="${command.title}">
		<meta name="twitter:description" content="${command.metaDescription}">
		<meta name="twitter:url" content="${communityEraContext.requestUrl}">
		<meta name="twitter:image:src" content="${command.markupImage}">
		
		<!-- Open Graph data -->
		<meta property="og:title" content="${command.title}" />
		<meta property="og:type" content="article" />
		<meta property="og:url" content="${communityEraContext.requestUrl}" />
		<meta property="og:image" content="${command.markupImage}" />
		<meta property="og:description" content="${command.metaDescription}" />
		<meta property="og:site_name" content="Jhapak" />
		<meta property="article:published_time" content="${command.isoPostedOn}" />
		<meta property="article:modified_time" content="${command.isoPostedOn}" />

		<meta property="fb:admins" content="100001187666357" />
	
		<%@ include file="/WEB-INF/jspf/commHeader.jspf" %>
		<%@ include file="/WEB-INF/jspf/header2.jspf"%>
		<%@ include file="/WEB-INF/jspf/headerTag.jspf"%>
		
		<%@ include file="/WEB-INF/jspf/extraJs.jspf" %>
		
		<link rel="stylesheet" media="all" type="text/css" href="css/commBnnr.css" />
		
		<script type="text/javascript" src="js/qtip/dynamicDropDownQtip.js"></script>
		<link rel="stylesheet" type="text/css" href="css/allMedia.css" />
		<cera:taggingJS context="${communityEraContext}"/>
		
		<style type="text/css">
			.documentlink {  background: url("${command.iconImage}") no-repeat left top; padding: 0 0 1.0em 1.7em; 	}
			.docRating{  background: url("${command.ratingImage}") no-repeat left top; padding: 0 0 1.0em 1.7em; 	}
			#usefulness {
				margin: 10px 0 30px 0;
				width: 100%;
			}
			
			#usefulness *, #usefulness {
				float: left;
			}
			
			#usefulness label {
				vertical-align: bottom;
				width: 2em;
			}
			
			#usefulness span {
				/* see ie.css */
				padding-top: 1.6em;
				margin-right: 1em;
				color: #AAA6A6;
				font-size: 13px;
				font-weight: bold;
			}
			
			#usefulness label .radio {
				display: block;
				float: none;
				/* see ie.css */
				left: -2px;
				position: relative;
			}
			
			.fileDetail {
				padding: 10px; 
				width: 700px; 
				margin: 0px 15px; 
			}
			
			.fileDetail table.fileDtlTbl tr {
				line-height: 24px;
			}
			
			.fileDetail table.fileDtlTbl th {
				text-align: left;
				vertical-align: top;
				font-weight: normal;
				color: #666;
				padding: 6px 26px 0px 0px;
				font-size: 13px;
				font-weight: bold;
			}
			.fileDetail table.fileDtlTbl td {
				width: 84%;
				padding: 6px 0px 0px 0px;
				font-size: 13px;
			}
			
			#container .left-panel .commSection .paginatedList .imgOuter {
				width: 100%;
				overflow: hidden;
				border: 1px solid rgba(0, 0, 0, 0.1);
				border-radius: 5px;
				display: inline-block;
				margin: 8px 0px;
				position: relative;
				overflow: hidden;
				vertical-align: top;
				cursor: pointer;
				line-height: inherit;
			}
			
			#container .left-panel .commSection .paginatedList .imgOuter img {
				width: 100%;
				position: relative;
				display: block;
				max-width: 100%;
				border: 0px none;
			}
		</style>
		
		<script type="text/javascript">
			// Initial call
			var editor_0;
			$(document).ready(function(){
				var config = {};
	        	config.toolbarGroups = [
										{ name: 'colors', groups: [ 'colors' ] },
										{ name: 'insert', groups: [ 'insert' ] },
										{ name: 'basicstyles', groups: [ 'bold'] },
										{ name: 'styles', groups: [ 'size' ] },
	                            	];
	        	config.toolbarLocation = 'top';
	        	config.removeButtons = 'Subscript,Superscript,Image,Flash,Table,Iframe,SpecialChar,HorizontalRule,PageBreak';
	        	editor_0 = CKEDITOR.appendTo( 'editor', config, '' );
	        	dynamicDropDownQtip();
				$('.memberInfo').each(function() {
			         $(this).qtip({
			            content: {
			        	 button: true,
			                text: function(event, api) {
			                    $.ajax({
			                        url: api.elements.target.attr('title') // Use href attribute as URL
			                    })
			                    .then(function(content) {
			                        api.set('content.text', content);
			                    }, function(xhr, status, error) {
			                        api.set('content.text', 'Loading...');
			                    });
			                    return 'Loading...'; // Set some initial text
			                }
			            },
			            position: {
			            	viewport: $(window),
			            	my: 'top right',  // Position my top left...
			                at: 'bottom right', // at the bottom right of...
			                target: 'mouse', // Position it where the click was...
							adjust: { 
								mouse: false 
							} // ...but don't follow the mouse
						},
						style: {
					        classes: 'qtip-bootstrap myCustomClass'
					    },
					    hide: {
			                fixed: true,
			                delay: 300
			            }
			         });
			     });
			     
				$.ajax({url:"${communityEraContext.contextUrl}/community/allCommunitiesCloud.ajx",dataType: "json",success:function(result){
					var aName = "<ul>";
					var fTagList = $("#fTagList").val();
					var commOption = $("#communityOption").val();
					var sortOption = $("#sortByOption").val();
					 $.each(result.aData, function() {
						 aName += "<li>";
						 aName += "<a href='${communityEraContext.contextUrl}/community/showCommunities.do?filterTag="+this['tagText']+"&fTagList="+fTagList+"&communityOption="+commOption+"&sortByOption="+sortOption+"' ";
						 aName += "title='View "+this['count']+" items tagged with &#39;"+this['tagText']+"&#39;' class='size-"+this['cloudSet']+"' >"+this['tagText']+"</a>";
						 aName += "</li>";
							});
					 $("#cloud").html(aName+"</ul>");
					 
					 var bName = "<table >";
					 $.each(result.bData, function() {
						 bName += "<tr><td>";
						 bName += "<span class='size-"+this['cloudSet']+"'  ><a href='${communityEraContext.contextUrl}/community/showCommunities.do?filterTag="+this['tagText']+"&fTagList="+fTagList+"&communityOption="+commOption+"&sortByOption="+sortOption+"' ";
						 bName += "title='View "+this['count']+" items tagged with &#39;"+this['tagText']+"&#39;' class='size-"+this['cloudSet']+"' >"+this['tagText']+"</a></span>";
						 bName += "</td><td style='color: rgb(42, 58, 71); float: right;'>["+this['count']+"]</td>";
						 bName += "</tr>";
							});
					 $("#cloudList").html(bName+"</table>");
	
					// Hide message
			        $("#waitCloudMessage").hide();
				    },
				 	// What to do before starting
			         beforeSend: function () {
			             $("#waitCloudMessage").show();
			         } 
			    });

				if(${command.pageCount} > 0){
					$("#pagination").jPaginator({ 
						nbPages:${command.pageCount},
						marginPx:5,
						length:6, 
						overBtnLeft:'#over_backward', 
						overBtnRight:'#over_forward', 
						maxBtnLeft:'#max_backward', 
						maxBtnRight:'#max_forward', 
						onPageClicked: function(a,num) { 
						$.ajax({url:"${communityEraContext.currentCommunityUrl}/library/documentdisplay.do?jPage="+num+"&fileID="+$("#fileID").val(),dataType: "json",success:function(result){
							var sName = "";
							$.each(result.aData, function() {
								 var rowId = this['id'];
								 var documentId = this['documentId'];
								 sName += "<div class='internalPagination'><div class='leftImg'>";
								 if(this['photoPresent']){
									 sName += "<a href='${communityEraContext.contextUrl}/pers/connectionResult.do?id="+this['posterId']+"&backlink=ref' ><img src='${communityEraContext.contextUrl}/pers/userPhoto.img?id="+this['posterId']+"' /></a>"; }
								 else {
									 sName += "<img src='img/user_icon.png'  />";
								 }
		
								 sName += "</div><div class='details'><div class='person'><a href='${communityEraContext.contextUrl}/pers/connectionResult.do?id="+this['posterId']+"&backlink=ref' style='padding:0px;'>"+this['displayName']+"</a><br /> commented on "+this['postedOn']+"</div>";
		
								 sName += "<div class='entry' id='div-"+rowId+"' >";
								 if(this['likeCommentCount'] > 1){
									 sName += "<span>"+this['likeCommentCount'] + " likes</span>";
								 } else {
									 sName += "<span>"+this['likeCommentCount'] + " like</span>";
								 }
								 
								 if (this['commentLikeAllowed']) {
									if (this['alreadyCommentLike']) {
										 sName += "<i class='a-icon-text-separator'></i><a href='javascript:void(0);' onclick='likeEntry("+documentId+", "+rowId+");' >Unlike</a>";
									} else {
										sName += "<i class='a-icon-text-separator'></i><a href='javascript:void(0);' onclick='likeEntry("+documentId+", "+rowId+");' >Like</a>";
									}
								 }
								sName += "</div>";
								sName += "<p>"+this['comment']+"</p></div></div><li class='lineseparater'></li>";
								
									});
							 $("#page").html(sName);
							// Hide message
						        $("#waitMessage").hide();
						        toggleOnLoad();
		
						        $('.memberInfo').each(function() {
							         $(this).qtip({
							            content: {
							        	 button: true,
							                text: function(event, api) {
							                    $.ajax({
							                        url: api.elements.target.attr('title') // Use href attribute as URL
							                    })
							                    .then(function(content) {
							                        api.set('content.text', content);
							                    }, function(xhr, status, error) {
							                        api.set('content.text', 'Loading...');
							                    });
							                    return 'Loading...'; // Set some initial text
							                }
							            },
							            position: {
							            	viewport: $(window),
							            	my: 'top right',  // Position my top left...
							                at: 'bottom right', // at the bottom right of...
							                target: 'mouse', // Position it where the click was...
											adjust: { 
												mouse: false 
											} // ...but don't follow the mouse
										},
										style: {
									        classes: 'qtip-bootstrap myCustomClass'
									    },
									    hide: {
							                fixed: true,
							                delay: 300
							            }
							         });
							     });
							     
							    },
							 	// What to do before starting
						         beforeSend: function () {
						             $("#waitMessage").show();
						         }
					    });
						} 
					});
				}
			});
		</script>
		
		<script type="text/javascript">
			function subscribeDocument(documentId){
				$.ajax({url:"${communityEraContext.currentCommunityUrl}/doclib/followDocument.ajx?id="+documentId,success:function(result){
		    	    $("#subscribeDocument").html(result);
		    	  }});
			}
		
			function unSubscribeDocument(documentId){
				BootstrapDialog.show({
	                type: BootstrapDialog.TYPE_WARNING,
	                title: 'Stop Following this Document',
	                message: '<p class="extraWord">You will no longer be able to receive email alerts when new comments are posted about this document.</p>',
	                closable: true,
	                closeByBackdrop: false,
	                closeByKeyboard: false,
	                buttons: [{
	                	label: 'Go',
	                    action: function(dialogRef){
	                        dialogRef.close();
	                        $.ajax({url:"${communityEraContext.currentCommunityUrl}/doclib/stopFollowingDocument.ajx?id="+documentId,success:function(result){
	            	    	    $("#subscribeDocument").html(result);
	            	    	  }});
	                    }
	                }, {
	                	label: 'Close',
	                    action: function(dialogRef){
	                        dialogRef.close();
	                    }
	                }]
	            });
			}

			function submitComment(){
				document.getElementById('comment').value = editor_0.getData();
				document.submitCommentForm.action = "${communityEraContext.currentCommunityUrl}/doclib/add-comment-rate.do";
				document.submitCommentForm.submit();
			}

			function likeEntry(fileId, commentId) 
			{ 
			    var isAuthenticated = $("#isAuthenticated").val();
			    if (isAuthenticated == 'false') {
			    	BootstrapDialog.show({
		                type: BootstrapDialog.TYPE_DANGER,
		                title: 'Error',
		                message: '<p class="addTagHeader">You are not logged-in.<br/> Please login first to like / unlike. </p>',
		                closable: true,
		                closeByBackdrop: false,
		                closeByKeyboard: false,
		                buttons: [{
		                	label: 'Close',
		                	cssClass: 'btn-danger',
		                    action: function(dialogRef){
		                        dialogRef.close();
		                    }
		                }]
		            });
			    } else if (commentId > 0) {
			    	$.ajax({url:"${communityEraContext.contextUrl}/library/likeFileComment.ajx?fileId="+fileId+"&commentId="+commentId,success:function(result){
			    	    $("#div-"+commentId).html(result);
			    	  }});
			    } else {
			    	$.ajax({url:"${communityEraContext.contextUrl}/library/likeFileComment.ajx?fileId="+fileId,success:function(result){
			    	    $("#likeUnike").html(result);
			    	  }});
			    }
			}

			function deleteFile(fileId){
				$(".qtip").hide();
				BootstrapDialog.show({
	                type: BootstrapDialog.TYPE_WARNING,
	                title: 'Delete File',
	                message: '<p style="padding: 15px;">Are you sure you want to delete this file?</p>',
	                closable: true,
	                closeByBackdrop: false,
	                closeByKeyboard: false,
	                buttons: [{
	                	id: 'button-cancel',
	                	label: 'Cancel',
	                    action: function(dialogRef){
	                        dialogRef.close();
	                    }
	                }, {
	                	id: 'button-confirm',
	                	label: 'Confirm',
	                	cssClass: 'btn-warning',
	                    action: function(dialogRef){
	                	dialogRef.getButton('button-cancel').disable();
	                	dialogRef.getButton('button-confirm').disable();
	                    dialogRef.getButton('button-confirm').spin();
	                	 $.ajax({url:"${communityEraContext.currentCommunityUrl}/library/deleteDocument.do?id="+fileId,success:function(result){
	                		 	var ref = '${communityEraContext.currentCommunityUrl}/library/showLibraryFolders.do';
	                     		window.location.href=ref;
	            	    		}
	            	    	});
	                    }
	                }]
	            });
			}
		</script>
		
	</head>

	<body id="communityEra">
		<%@ include file="/WEB-INF/jspf/topHeader.jspf" %>
		<div class="commBanr">
			<div class="bnrImg" style="background-image:url(${communityEraContext.contextUrl}/commLogoDisplay.img?showType=m&imgType=Banner&communityId=${communityEraContext.currentCommunity.id});" >
				<div class="innerPanl">
					<div class="carousel_caption">
						<c:if test="${communityEraContext.currentCommunity.communityType == 'Private'}">
							<h4><i class="fa fa-lock" style="margin-right: 8px;"></i>${communityEraContext.currentCommunity.name}</h4>
						</c:if>
						<c:if test="${communityEraContext.currentCommunity.communityType == 'Protected'}">
							<h4><i class="fa fa-shield" style="margin-right: 8px;"></i>${communityEraContext.currentCommunity.name}</h4>
						</c:if>
						<c:if test="${communityEraContext.currentCommunity.communityType == 'Public'}">
							<h4><i class="fa fa-globe" style="margin-right: 8px;"></i>${communityEraContext.currentCommunity.name}</h4>
						</c:if>
						<p>${communityEraContext.currentCommunity.welcomeText}</p>							
					</div>
					<div class="menuContainer">
						<ul id="gn-menu" class="gn-menu-main">
							<li><a href="${communityEraContext.currentCommunityUrl}/library/showLibraryItems.do"><i class="fa fa-folder-open" style="margin-right: 8px;"></i>Library</a></li>
							<li>
								<nav id="menu">
						    		<input type="checkbox" id="toggle-nav"/>
						    		<label id="toggle-nav-label" for="toggle-nav"><i class="fa fa-bars"></i></label>
						    		<div class="box">
							    		<ul>
							    			<li><a href="${communityEraContext.currentCommunityUrl}/home.do"><i class="fa fa-home" style="margin-right: 8px;"></i>Home</a></li>
							    			<c:forEach items="${communityEraContext.enabledFeatureNamesForCurrentCommunity}" var="feature">
												<c:if test="${feature == 'Assignments'}">
													<li><a href="${communityEraContext.currentCommunityUrl}/assignment/showAssignments.do"><i class="fa fa-briefcase" style="margin-right: 8px;"></i>Assignments</a></li>
												</c:if>
												<c:if test="${feature == 'Blog'}">
													<li><a href="${communityEraContext.currentCommunityUrl}/blog/viewBlog.do"><i class="fa fa-quote-left" style="margin-right: 8px;"></i>Blogs</a></li>
												</c:if>
												<c:if test="${feature == 'Forum'}">
													<li><a href="${communityEraContext.currentCommunityUrl}/forum/showTopics.do"><i class="fa fa-comments-o" style="margin-right: 8px;"></i>Forums</a></li>
												</c:if>
												<c:if test="${feature == 'Wiki'}">
													<li><a href="${communityEraContext.currentCommunityUrl}/wiki/showWikiEntries.do"><i class="fa fa-book" style="margin-right: 8px;"></i>Wikis</a></li>
												</c:if>
												<c:if test="${feature == 'Members'}">
													<li><a href="${communityEraContext.currentCommunityUrl}/connections/showConnections.do"><i class="fa fa-user-plus" style="margin-right: 8px;"></i>Members</a></li>
												</c:if>
												<c:if test="${feature == 'Events'}">
													<li><a href="${communityEraContext.currentCommunityUrl}/event/showEvents.do"><i class="fa fa-calendar-check-o" style="margin-right: 8px;"></i>Events</a></li>
												</c:if>
											</c:forEach>
							    		</ul>
						    		</div>
						    	</nav>
					    	</li>
						</ul>
					</div><!-- /container -->
					<div class="groups">
						<div class="picture">
							<c:choose>
								<c:when test="${communityEraContext.currentCommunity.logoPresent}">		
									<img src="${communityEraContext.contextUrl}/commLogoDisplay.img?showType=m&communityId=${communityEraContext.currentCommunity.id}" width="290" height="290" /> 
								</c:when>
								<c:otherwise>
									<img src="img/community_Image.png" id="photoImg" width="290" height="290" />
								</c:otherwise>
							</c:choose>
						</div>
					</div>
				</div>
				<%-- <div class="nav-list">
					<ul>
						<li><a href="${communityEraContext.currentCommunityUrl}/home.do">Home</a></li>
						<li><a href="${communityEraContext.currentCommunityUrl}/blog/viewBlog.do">Blogs</a></li>
						<li><a href="${communityEraContext.currentCommunityUrl}/event/showEvents.do">Events</a></li>
						<li><a href="${communityEraContext.currentCommunityUrl}/forum/showTopics.do">Forums</a></li>
						<li class="selected">
							<a href="${communityEraContext.currentCommunityUrl}/library/showLibraryItems.do" class="dynaDropDown" 
								title="community/communityOptions.ajx?currId=1005&commId=${communityEraContext.currentCommunity.id}">Library <span class='ddimgWht'/></a>
						</li>
						<li><a href="${communityEraContext.currentCommunityUrl}/connections/showConnections.do">Connections</a></li>
						<li><a href="${communityEraContext.currentCommunityUrl}/wiki/showWikiEntries.do">Wikis</a></li>  
					</ul>
				</div> --%>
			</div>
		</div>
		<div id="container">
			<div class="left-panel">
				<input type="hidden" id="fileID" name="fileID" value="${command.id}" />
				<div class="commSection">
					<div class="paginatedList" style="padding: 0px; margin: 0px 0PX 10px auto;">
						<div class="topSection" >
							<div class="leftImg">							
								<c:choose>
									<c:when test="${command.photoPresent}">						 
										 <a href="${communityEraContext.contextUrl}/pers/connectionResult.do?id=${command.posterId}&backlink=ref">
										 <img src="${communityEraContext.contextUrl}/pers/userPhoto.img?id=${command.posterId}"/></a>
									</c:when>
									<c:otherwise>
										<img src="img/user_icon.png" />
									</c:otherwise>
								</c:choose>
							</div>
							<div class="topHeader" >
								<div class="heading" style="width: 600px; color: #184A72; margin-bottom: 2px;">
									<span style="font-size: 20px; font-weight: bold;">${command.title}</span>
								</div>
								<div class="subHeader">
									Added by <a href="${communityEraContext.contextUrl}/pers/connectionResult.do?id=${command.posterId}" class="memberInfo" 
									title="${communityEraContext.contextUrl}/pers/connectionInfo.do?id=${command.posterId}">${command.displayName}</a>
									on ${command.postedOn}
								</div>
								<c:if test="${command.overallRating>0}">
									<div class="subHeader">
										<c:choose>
											<c:when test='${command.numberOfRaters < 2}'><strong>${command.numberOfRaters}</strong> member</c:when>
											<c:otherwise>${command.numberOfRaters} members</c:otherwise>
										</c:choose>
										<img src="img/i/icon-${command.overallRating}stars.gif" alt="${command.overallRating} Stars" style="display: inline;" />
									</div>
								</c:if>
								<div class="subHeader"> 
									<c:choose>
										<c:when test='${command.downloads < 2}'><strong>${command.downloads}</strong> download</c:when>
										<c:otherwise><strong>${command.downloads}</strong> downloads</c:otherwise>
									</c:choose>
									<i class='a-icon-text-separator'></i>
									<c:if test="${command.downloads > 0}">
										Last download at ${command.lastDownloadTime} <i class='a-icon-text-separator'></i>
									</c:if>
									<c:choose>
										<c:when test='${command.commentCount < 2}'>${command.commentCount} comment</c:when>
										<c:otherwise>${command.commentCount} comments</c:otherwise>
									</c:choose>
								</div>
								<div class="subHeader" id="taggedKeywords">
									<c:if test="${not empty command.taggedKeywords}">
									<i class='fa fa-tags' style='font-size: 14px; margin-right: 4px;'></i>${command.taggedKeywords}
									</c:if>
								</div>
							</div> 
							<div class="menus" style="width: 100%; margin-top: 8px;">
								<ul style="margin-top: 6px; float: right;">
									<c:if test="${command.writeAllowed}">
										<li><a href="${communityEraContext.currentCommunityUrl}/library/editDocument.do?id=${command.id}"
													title="Edit this file">Edit File</a></li>
										<li><a onclick="deleteFile(${command.id});" href="javascript:void(0);"
													title="Delete this file">Delete File</a></li>
									</c:if>
									<c:if test="${command.currentUserSubscribed}">
										<li id="subscribeDocument"><a onclick="unSubscribeDocument(${command.id});" href="javascript:void(0);"
												title="Unsubscribe from email alerts about this file">Stop Following</a></li>
									</c:if>
									<c:if test="${not command.currentUserSubscribed}">
										<li id="subscribeDocument"><a onclick="subscribeDocument(${command.id});" href="javascript:void(0);"
										 		title="Get email alerts about this file">Follow</a></li>
									</c:if>
								</ul>
							</div>
						</div>
						<c:if test="${command.iconType == 'img'}">
							<div style="padding: 10px 20px;">
								<div class='imgOuter'>
									<img src='${communityEraContext.contextUrl}/community/getCommunityMedia.img?id=${command.id}' />
								</div>
							</div>
						</c:if>
							
						<div class="fileDetail" >
							<table cellpadding="0" cellspacing="0" class="fileDtlTbl">
								<tbody>
									<tr>
										<th>
												<c:if test="${command.iconType == 'xls'}">
													<img src='img/file/excelicon.gif' style="max-height: 50px;"/>
												</c:if>
												<c:if test="${command.iconType == 'zip'}">
													<img src='img/file/zipicon.gif' style="max-height: 50px;"/>
												</c:if>
												<c:if test="${command.iconType == 'pdf'}">
													<img src='img/file/pdficon.gif' style="max-height: 50px;"/>
												</c:if>
												<c:if test="${command.iconType == 'xml'}">
													<img src='img/file/excelicon.gif' style="max-height: 50px;"/>
												</c:if>
												<c:if test="${command.iconType == 'img'}">
													<img src='img/file/imgicon.gif' style="max-height: 50px;"/>
												</c:if>
												<c:if test="${command.iconType == 'doc'}">
													<img src='img/file/wordicon.gif' style="max-height: 50px;"/>
												</c:if>
												<c:if test="${command.iconType == 'ppt'}">
													<img src='img/file/powerpointicon.gif' style="max-height: 50px;"/>
												</c:if>
												<c:if test="${command.iconType == 'file' || command.iconType == ''}">
													<img src='img/file/fileicon.gif' style="max-height: 50px;"/>
												</c:if>
										</th>
										<td style="color: #184A72;">${command.fileName} <a href="${communityEraContext.currentCommunityUrl}/library/downloadFile.do?id=${command.id}" 
													class="btnmain" style="float: right;" title="Opens a new window containing attached file"><i class="fa fa-download"></i> Download</a></td>
									</tr>
									<tr><th>Description:</th><td><div class="richtext"><p>${command.description}</p></div></td></tr>
									<tr><th>Created:</th><td>${command.postedOn} by <a href="${communityEraContext.contextUrl}/pers/connectionResult.do?id=${command.posterId}" class="memberInfo" 
										style="color: #66799f; font-weight: bold;" title="${communityEraContext.contextUrl}/pers/connectionInfo.do?id=${command.posterId}">${command.displayName}</a></td></tr>
									<tr><th>Last Update:</th><td>${command.modifyiedOn}</td></tr>
									<tr><th>Size:</th><td>${command.sizeInKb} Kb</td></tr>
									<c:if test="${command.overallRating > 0}">
										<tr>
											<th>Rating:</th>
											<td>
												<img src="img/i/icon-${command.overallRating}stars.gif" alt="${command.overallRating} Stars" style="display: inline;" />
												<c:choose>
													<c:when test='${command.numberOfRaters < 2}'>by <strong>${command.numberOfRaters}</strong> member</c:when>
													<c:otherwise>by <strong>${command.numberOfRaters}</strong> members</c:otherwise>
												</c:choose>
											</td>
										</tr>
									</c:if>
									<c:if test="${command.overallRating == 0}">
										<tr><th>Rating:</th><td>No rating yet.</td></tr>
									</c:if>
									<tr>
										<th>Downloads:</th>
										<c:if test="${command.downloads > 0}">
											<td>
												${command.downloads} (last download: ${command.lastDownloadTime})
											</td>
										</c:if>
										<c:if test="${command.downloads == 0}">
											<td>
												0 download
											</td>
										</c:if>
									</tr>
									<tr><th>Comments:</th><td>${command.commentCount}</td></tr>
								</tbody>
							</table>
						</div>
						<div class='outerBlock' >
							<c:if test="${command.commentCount > 0}">
								<%-- <c:if test="${communityEraContext.userCommunityAdmin}">
										<a href="${communityEraContext.currentCommunityUrl}/doclib/edit-comment.do?backlink=ref&amp;id=${row.id}" title="Edit this comment">Edit</a>
									&nbsp;|&nbsp;<a href="${communityEraContext.currentCommunityUrl}/doclib/delete-comment.do?backlink=ref&amp;id=${row.id}" title="Delete this comment">Remove</a>
									</c:if> --%>
								<div id="page"></div>
								<div id="waitMessage" style="display: none;">
									<div class="cssload-square" >
										<div class="cssload-square-part cssload-square-green" ></div>
										<div class="cssload-square-part cssload-square-pink" ></div>
										<div class="cssload-square-blend" ></div>
									</div>
								</div>
								<%@ include file="/WEB-INF/jspf/pagination.jspf" %>
								<br />
								<br />
							</c:if>
							
							<div style="margin-top: 10px;">
								<form:form showFieldErrors="true" commandName="command" name="submitCommentForm" >
									<form:hidden path="id" />
									<label for="comment" >Add your comment</label>	
									<textarea tabindex="1" name='comment' id='comment' style='display:none;'></textarea><div id='editor'></div>
									<div id="usefulness">
										<span style=" width: 100%; color: #184A72;"><h5>Rate the usefulness of this file</h5></span>
										<span>Not useful</span>
										<label>1 <input class="radio" type="radio" value="1" name="rating" <c:if test="${command.rating==1}">checked </c:if>/></label>
										<label>2 <input class="radio" type="radio" value="2" name="rating" <c:if test="${command.rating==2}">checked </c:if>/></label>
										<label>3 <input class="radio" type="radio" value="3" name="rating" <c:if test="${command.rating==3}">checked </c:if>/></label>
										<label>4 <input class="radio" type="radio" value="4" name="rating" <c:if test="${command.rating==4}">checked </c:if>/></label>
										<label>5 <input class="radio" type="radio" value="5" name="rating" <c:if test="${command.rating==5}">checked </c:if>/></label>
										<span>Very useful</span>
									</div>
								</form:form>
								<div class="left" style="margin: 10px 0px;">
									<a href="javascript:void(0);" onclick="submitComment();" class="btnmain" style='float:right;'>Post</a>
								</div>	
							</div>
						</div> 
					</div> 
				</div>
			</div> 
			
			<div class="right-panel">
				<div class="inbox">
					<div class="eyebrow">
						<span><i class="fa fa-tags" style="margin-right: 2px;"></i>Popular Tags</span>
					</div>
					<div id="cloud" class="communities"></div>
					<div id="waitCloudMessage" style="display: none;">
						<div class="cssload-square" style="width: 13px; height: 13px;">
							<div class="cssload-square-part cssload-square-green" style="width: 13px; height: 13px;"></div>
							<div class="cssload-square-part cssload-square-pink" style="width: 13px; height: 13px;"></div>
							<div class="cssload-square-blend" style="width: 13px; height: 13px;"></div>
						</div>
					</div>
					<div id="cloudList" style="display: none; " class="communities"></div>
					<ul id="cloudTabs">
						<c:choose>
							<c:when test="${command.toggleList == 'true'}">
								<h3 class="selectedCloudTab" id="hCloud" style="display: none; float:left;">Cloud<i class='a-icon-text-separator'></i></h3>
								<a href="javascript: toggle()" style="float:left; color: #66799f;" id="aCloud">Cloud<i class='a-icon-text-separator'></i></a>
								<h3 class="selectedCloudTab" style="float:right;" id="hCloudList">List</h3>
								<a href="javascript: toggle()" id="aCloudList" style="display: none; float:right; color: #66799f;">List</a>
							</c:when>
							<c:otherwise>
								<h3 class="selectedCloudTab" id="hCloud" style="float:left;">Cloud<i class='a-icon-text-separator'></i></h3>
								<a href="javascript: toggle()" style="display: none; float:left; color: #66799f;" id="aCloud">Cloud<i class='a-icon-text-separator'></i></a>
								<h3 class="selectedCloudTab" style="display: none; float:right;" id="hCloudList">List</h3>
								<a href="javascript: toggle()" id="aCloudList" style="float:right; color: #66799f;">List</a>
						  	</c:otherwise>
						</c:choose>
					</ul>
				</div>
			</div>
		</div>
		<%@ include file="/WEB-INF/jspf/footer.jspf" %>
		<%@ include file="/WEB-INF/jspf/extraFooter.jspf" %>
		<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-57b6850a24ae6e28"></script>
	</body>
</html>		